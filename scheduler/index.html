<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="generator" content="Hugo 0.56.0-DEV" />
    <meta name="description" content="Lity is a new programming language for building blockchain smart contracts.">


    <link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
<link rel="icon" href="/images/favicon.png" type="image/x-icon" />
    <title>Scheduler :: The Lity Language and Virtual Machine for Smart Contracts</title>

    
    <meta property="og:title" content="Scheduler" />
    <meta property="og:description" content="Lity is a new programming language for building blockchain smart contracts." />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="http://www.litylang.org/scheduler/" />
    <meta property="og:image" content="http://www.litylang.org/images/lity@3x-pad.jpg" />

    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-120065893-5', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

    
    
    <link href="/css/nucleus.css?1555397061" rel="stylesheet">
    <link href="/css/font-awesome.min.css?1555397061" rel="stylesheet">
    <link href="/css/hybrid.css?1555397061" rel="stylesheet">
    <link href="/css/featherlight.min.css?1555397061" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1555397061" rel="stylesheet">
    <link href="/css/auto-complete.css?1555397061" rel="stylesheet">
    <link href="/css/theme.css?1555397061" rel="stylesheet">
    <link href="/css/hugo-theme.css?1555397061" rel="stylesheet">
    

    <script src="/js/jquery-2.x.min.js?1555397061"></script>
    
    <style type="text/css">
      :root #header + #content > #left > #rlblock_left{ 
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/scheduler/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="/">
  <img src='/images/lity@3x.png' alt="lityLogo" />
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fa fa-search"></i></label>
    <input data-search-input id="search-by" type="text" placeholder="Search...">
    <span data-search-clear=""><i class="fa fa-close"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1555397061"></script>
<script type="text/javascript" src="/js/auto-complete.js?1555397061"></script>
<script type="text/javascript">
    
        var baseurl = '\/';
    
</script>
<script type="text/javascript" src="/js/search.js?1555397061"></script>

    
  </div>

    <div class="highlightable">
        <ul class="topics">    
                
                
                


 
  
    
    <li data-nav-id="/getting_started/" title="Getting started" class="dd-item 
        
        
        
        ">
      <a href="/getting_started/">
          Getting started
          
      </a>
      <ul id="sidebar-toc">
          <nav id="TableOfContents">
<ul>
<li><a href="#getting-started">Getting Started</a>
<ul>
<li>
<ul>
<li><a href="#download-and-install">Download and install</a></li>
<li><a href="#a-reverse-hello-world">A reverse Hello World</a></li>
<li><a href="#start-a-cybermiles-node">Start a CyberMiles node</a></li>
<li><a href="#run-the-smart-contract">Run the smart contract</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
      </ul>
      
              
    </li>
  
 

                
                


 
  
    
    <li data-nav-id="/performance/" title="Performance" class="dd-item 
        
        
        
        ">
      <a href="/performance/">
          Performance
          
      </a>
      <ul id="sidebar-toc">
          <nav id="TableOfContents">
<ul>
<li><a href="#performance">Performance</a>
<ul>
<li>
<ul>
<li><a href="#use">Use</a></li>
<li><a href="#develop">Develop</a></li>
<li><a href="#governance">Governance</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
      </ul>
      
              
    </li>
  
 

                
                


 
  
    
    <li data-nav-id="/security/" title="Security" class="dd-item 
        
        
        
        ">
      <a href="/security/">
          Security
          
      </a>
      <ul id="sidebar-toc">
          <nav id="TableOfContents">
<ul>
<li><a href="#security">Security</a>
<ul>
<li>
<ul>
<li><a href="#erc-checker">ERC checker</a></li>
<li><a href="#static-analysis">Static analysis</a></li>
<li><a href="#overflow-protection">Overflow protection</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
      </ul>
      
              
    </li>
  
 

                
                


 
  
    
    <li data-nav-id="/trusted/" title="Oracles" class="dd-item 
        
        
        
        ">
      <a href="/trusted/">
          Oracles
          
      </a>
      <ul id="sidebar-toc">
          <nav id="TableOfContents">
<ul>
<li><a href="#trusted-smart-contracts">Trusted Smart Contracts</a></li>
</ul>
</nav>
      </ul>
      
              
    </li>
  
 

                
                


 
  
    
    <li data-nav-id="/rand/" title="Random Numbers" class="dd-item 
        
        
        
        ">
      <a href="/rand/">
          Random Numbers
          
      </a>
      <ul id="sidebar-toc">
          <nav id="TableOfContents">
<ul>
<li><a href="#secure-random-numbers">Secure Random Numbers</a></li>
</ul>
</nav>
      </ul>
      
              
    </li>
  
 

                
                


 
  
    
    <li data-nav-id="/scheduler/" title="Scheduler" class="dd-item 
        parent
        active
        
        ">
      <a href="/scheduler/">
          Scheduler
          
      </a>
      <ul id="sidebar-toc">
          <nav id="TableOfContents">
<ul>
<li><a href="#scheduler">Scheduler</a>
<ul>
<li>
<ul>
<li><a href="#challenge">Challenge</a></li>
<li><a href="#cybermiles-support">CyberMiles support</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
      </ul>
      
              
    </li>
  
 

                
                


 
  
    
    <li data-nav-id="/business_rules/" title="Business Rules" class="dd-item 
        
        
        
        ">
      <a href="/business_rules/">
          Business Rules
          
      </a>
      <ul id="sidebar-toc">
          <nav id="TableOfContents">
<ul>
<li><a href="#business-rules">Business Rules</a></li>
</ul>
</nav>
      </ul>
      
              
    </li>
  
 

                
                


 
  
    
    <li data-nav-id="/number/" title="Real Arithmetic" class="dd-item 
        
        
        
        ">
      <a href="/number/">
          Real Arithmetic
          
      </a>
      <ul id="sidebar-toc">
          <nav id="TableOfContents">
<ul>
<li><a href="#real-number-support">Real Number Support</a></li>
</ul>
</nav>
      </ul>
      
              
    </li>
  
 

                
                


 
  
    
    <li data-nav-id="/gas/" title="Free Gas" class="dd-item 
        
        
        
        ">
      <a href="/gas/">
          Free Gas
          
      </a>
      <ul id="sidebar-toc">
          <nav id="TableOfContents">
<ul>
<li><a href="#free-gas">&ldquo;Free&rdquo; Gas</a></li>
</ul>
</nav>
      </ul>
      
              
    </li>
  
 

                
             
        </ul>
    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://github.com/CyberMiles/lity" target="_blank"><i class='fa fa-fw fa-github'></i> Lity source</a>
              </li>
          
              <li> 
                  <a class="padding" href="http://lity.readthedocs.io/" target="_blank"><i class='fa fa-fw fa-file'></i> Lity docs</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://github.com/CyberMiles/libeni" target="_blank"><i class='fa fa-fw fa-github'></i> libENI source</a>
              </li>
          
              <li> 
                  <a class="padding" href="http://libeni.readthedocs.io/" target="_blank"><i class='fa fa-fw fa-file'></i> libENI docs</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://github.com/CyberMiles/travis" target="_blank"><i class='fa fa-fw fa-github'></i> CyberMiles source</a>
              </li>
          
              <li> 
                  <a class="padding" href="http://travis.readthedocs.io/" target="_blank"><i class='fa fa-fw fa-file'></i> CyberMiles docs</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <center>
    
    <a class="github-button" href="https://github.com/CyberMiles/lity/archive/lity.zip" data-icon="octicon-cloud-download" aria-label="Download matcornic/hugo-theme-learn on GitHub">Download</a>

    
    <a class="github-button" href="https://github.com/CyberMiles/lity" data-icon="octicon-star" data-show-count="true" aria-label="Star matcornic/hugo-theme-learn on GitHub">Star</a>

    
    <a class="github-button" href="https://github.com/CyberMiles/lity/fork" data-icon="octicon-repo-forked" data-show-count="true" aria-label="Fork matcornic/hugo-theme-learn on GitHub">Fork</a>

</center>

<script async defer src="https://buttons.github.io/buttons.js"></script>

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
            
              <div>
                <div id="top-bar">
                
                
                <a id="mobile-logo" href="/">
                    <img src='/images/lity_blue@3x.png' alt="lityLogo" />
                  </a>
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fa fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
                  
                  <span class="links">
                    
          
          
            
            
          
          
            <a href='/'>Litylang</a> > Scheduler
          
         
          
           
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li><a href="#scheduler">Scheduler</a>
<ul>
<li>
<ul>
<li><a href="#challenge">Challenge</a></li>
<li><a href="#cybermiles-support">CyberMiles support</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            

        
          <div id="chapter">
        
        <div id="body-inner">
          

        




<h1 id="scheduler">Scheduler</h1>

<p>One of the most glaring limitations of the Ethereum platform is the lack of support for timers. Without a timer, the DApp would not be able to perform tasks such as transferring funds or executing a contract at a specified future date. That means the Ethereum smart contracts cannot easily support common real-world financial contracts such as</p>

<ul>
<li>Installments for e-commerce purchases</li>
<li>Timeouts for various business processes that might not have definitive outcomes (eg product delivery)</li>
<li>Product warranty and scheduled services</li>
<li>Wills and trusts</li>
<li>College or retirement savings</li>
<li>Pension</li>
<li>Payroll</li>
<li>Stock (or coin) options</li>
<li>Dividends</li>
<li>Interest payments</li>
<li>Insurance payments</li>
<li>Mortgage payments</li>
<li>And many more</li>
</ul>

<p>That is about to change. Through engineering optimization and innovation, the CyberMiles blockchain will support timer-based transactions, including fully Ethereum-compatible fund transfers and contract executions scheduled for the future. We will also introduce a new language keyword, schedule, to support timer-based executions inside smart contracts.</p>

<h3 id="challenge">Challenge</h3>

<p>The lack of timer support in Ethereum is not an accident or oversight. It is due to the lack of exact time on the Proof-of-Work blockchain system. When a transaction is submitted to a blockchain, it arrives on different nodes at different times; it could be executed by different nodes at slightly different times; it could be packaged into the next block or the next 100th block by miners. Not being able to predict when (or even whether) a transaction will be executed and confirmed by miners, Ethereum does not provide a facility to trigger operations on a future time.</p>

<p>Therefore, on Ethereum, timer-based operations are triggered by <a href="http://www.ethereum-alarm-clock.com/">external off-chain computers or humans that keep time</a>. Those <a href="https://hackernoon.com/oracles-help-smart-contracts-resolve-subjective-events-d81639d8291c">time oracles</a> maintain timer events and send transactions to the blockchain when tasks are due. However, the issue with the time oracles is that they are centralized entities and therefore could cheat or become unavailable at crucial moments.</p>

<p>There are also many efforts to create a decentralized timer system (called <a href="http://www.ethereum-alarm-clock.com/">alarm clock</a>) on Ethereum. The idea is to create a cryptoeconomic game to incentivize a network of off-chain nodes to report time. We find these efforts complicated, non-scalable, and ultimately too expensive.</p>

<blockquote>
<p><em>The blockchain uncertainty principle</em>: the timing accuracy and cost of the of scheduled tasks are complementary variables. A short block time leads to more accurate execution time window but also more system overhead to frequently check for due tasks.</p>
</blockquote>

<h3 id="cybermiles-support">CyberMiles support</h3>

<p>The CyberMiles blockchain is a new generation of DPoS blockchain that features short block time and fast finality. Therefore, it is possible for validator nodes to act on scheduled tasks within the time window of a block. After the validators reach consensus on a new block, all nodes will examine the block&rsquo;s official timestamp and then execute tasks scheduled within the next block time from this timestamp. Since the official timestamp is created by the block proposer node, and the block is instantly final, this approach does not depend on each node&rsquo;s clock and hence produces deterministic outcomes on all nodes.</p>

<p>We will introduce a new keyword in the Lity programming language, schedule. You can use it to schedule future fund transfers from inside a smart contract, like this.</p>

<pre><code>schedule(transfer(), future_timestamp)
</code></pre>

<blockquote>
<p>CyberMiles supports a new optional transaction parameter called <code>scheduled_time</code>. When you add this parameter to any transaction, including fund transfer and smart contract execution, it will be scheduled to run in the future. Notice that this scheduled transaction will be recorded in the current block (with the current nonce), but it&rsquo;s execution (ie updates to the state machine) happens in the scheduled future time.</p>
</blockquote>

<p>The scheduled tasks incur higher gas costs as they require more computational resources to check. The further a task is scheduled for the future, the more gas it incurs.</p>

<p>One of the first and simplest applications for this functionality is the &ldquo;trust and will&rdquo; smart contract, where you can specify to transfer your funds to another account after a certain period unless you specifically cancel. It is similar to the <a href="https://support.google.com/accounts/answer/3036546?hl=en">Google Inactive Account Manager</a>, but for automatic transferring of value instead of information.</p>

<p>As we mentioned at the beginning of this chapter, the timer-based long running contracts represent a whole new class of smart contracts that have been proven useful in many real-world use cases.</p>


<footer class=" footline" >
	
</footer>

        
            </div> 
        
        </div> 
        

      </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1555397061"></script>
    <script src="/js/perfect-scrollbar.min.js?1555397061"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1555397061"></script>
    <script src="/js/jquery.sticky.js?1555397061"></script>
    <script src="/js/featherlight.min.js?1555397061"></script>
    <script src="/js/html5shiv-printshiv.min.js?1555397061"></script>
    <script src="/js/highlight.pack.js?1555397061"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom.71422.js?1555397061"></script>
    <script src="/js/learn.js?1555397061"></script>
    <script src="/js/hugo-learn.js?1555397061"></script>

    <link href="/mermaid/mermaid.css?1555397061" type="text/css" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1555397061"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

<div class="custom-footer">
    <center>
        
        <a class="github-button" href="https://github.com/CyberMiles/lity/archive/lity.zip" data-icon="octicon-cloud-download" aria-label="Download matcornic/hugo-theme-learn on GitHub">Download</a>

        
        <a class="github-button" href="https://github.com/CyberMiles/lity" data-icon="octicon-star" data-show-count="true" aria-label="Star matcornic/hugo-theme-learn on GitHub">Star</a>

        
        <a class="github-button" href="https://github.com/CyberMiles/lity/fork" data-icon="octicon-repo-forked" data-show-count="true"
            aria-label="Fork matcornic/hugo-theme-learn on GitHub">Fork</a>

    </center>
    <center class="copyright-text">Copyright © 2018. All rights reserved</center>
    
    <script async defer src="https://buttons.github.io/buttons.js"></script>
</div>
  </body>
</html>
